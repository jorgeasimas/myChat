(this["webpackJsonpmy-chat"]=this["webpackJsonpmy-chat"]||[]).push([[0],{1006:function(e,n){},1008:function(e,n){},1010:function(e,n){},1036:function(e,n){},1038:function(e,n){},1080:function(e,n){},1082:function(e,n){},1127:function(e,n,t){"use strict";t.r(n);var r=t(3),c=t.n(r),a=t(209),s=t.n(a),i=(t(578),t(175),t(171),t(143),t(170),t(6)),o=t.n(i),u=t(85),l=t(137),p=t(72);p.a.initializeApp({apiKey:"AIzaSyBjtl5dVm-h0Uah1Kwt65--WnZJJRNlamo",authDomain:"my-chat-a7b6d.firebaseapp.com",projectId:"my-chat-a7b6d",storageBucket:"my-chat-a7b6d.appspot.com",messagingSenderId:"1074409928589",appId:"1:1074409928589:web:a9e5e3b5728e8377feefc4",measurementId:"G-NW4RYNZQ6E"}),p.a.analytics();var d=p.a.auth(),b=p.a.firestore(),f=(p.a.analytics(),b.collection("users")),g=function(){var e=Object(l.a)(o.a.mark((function e(n,t){var r,c,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return r=b.doc("users/".concat(n.uid)),e.next=5,r.get();case 5:if(e.sent.exists){e.next=17;break}return c=n.displayName,a=n.email,s=new Date,e.prev=9,e.next=12,r.set(Object(u.a)({displayName:c,email:a,createdAt:s},t));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.log("error creating user",e.t0.message);case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(n,t){return e.apply(this,arguments)}}(),m=new p.a.auth.GoogleAuthProvider;m.setCustomParameters({prompt:"select_account"}),f.get().then((function(e){e.forEach((function(e){console.log(e.data().displayName," => ",e.data())}))}));p.a;var j=t(139),x=t(48),h=t(573),O=t(174),v=o.a.mark(C),S=o.a.mark(E),y=o.a.mark(A),w=o.a.mark(R),I=o.a.mark(T),U=o.a.mark(z),k=o.a.mark(L),N=o.a.mark(F),_=function(e){return{type:"SIGN_IN_FAILURE",payload:e}},G={currentUser:null,error:null};function C(e,n){var t,r;return o.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Object(x.b)(g,e,n);case 3:return t=c.sent,c.next=6,t.get();case 6:return r=c.sent,console.log(r),c.next=10,Object(x.c)({type:"SIGN_IN_SUCCESS",payload:Object(u.a)({id:r.id},r.data())});case 10:c.next=16;break;case 12:return c.prev=12,c.t0=c.catch(0),c.next=16,Object(x.c)(_(c.t0));case 16:case"end":return c.stop()}}),v,null,[[0,12]])}function E(){var e,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("sigining in with google"),t.prev=1,t.next=4,Object(x.b)((function(){return d.signInWithPopup(m)}));case 4:return e=t.sent,n=e.user,t.next=8,C(n);case 8:console.log(n),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(1),t.next=15,Object(x.c)(_(t.t0));case 15:case"end":return t.stop()}}),S,null,[[1,11]])}function A(){var e;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,new Promise((function(e,n){var t=d.onAuthStateChanged((function(n){t(),e(n)}),n)}));case 3:if(e=n.sent){n.next=6;break}return n.abrupt("return");case 6:return n.next=8,C(e);case 8:n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(0),n.next=14,Object(x.c)(_(n.t0));case 14:case"end":return n.stop()}}),y,null,[[0,10]])}function R(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.signOut();case 3:return e.next=5,Object(x.c)({type:"SIGN_OUT_SUCCESS"});case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,Object(x.c)({type:"SIGN_OUT_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),w,null,[[0,7]])}function T(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.d)("GOOGLE_SIGN_IN_START",E);case 2:case"end":return e.stop()}}),I)}function z(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.e)("CHECK_USER_SESSION",A);case 2:case"end":return e.stop()}}),U)}function L(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.e)("SIGN_OUT_START",R);case 2:case"end":return e.stop()}}),k)}function F(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.a)([Object(x.b)(T),Object(x.b)(E),Object(x.b)(z),Object(x.b)(A),Object(x.b)(L)]);case 2:case"end":return e.stop()}}),N)}var B=Object(h.a)(),D=Object(O.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SIGN_IN_SUCCESS":return Object(u.a)(Object(u.a)({},e),{},{currentUser:n.payload,error:null});case"SIGN_OUT_SUCCESS":return console.log("sign in success"),Object(u.a)(Object(u.a)({},e),{},{currentUser:null,error:null});case"SIGN_IN_FAILURE":case"SIGN_OUT_FAILURE":return Object(u.a)(Object(u.a)({},e),{},{error:n.payload});default:return e}}),Object(O.a)(B));B.run(F);var J=D,P=t(10);function K(){return d.currentUser&&Object(P.jsx)("button",{className:"sign-out",onClick:function(){return d.signOut()},children:"Sign Out"})}function V(e){var n=e.googleSignInStart,t=e.currentUser;console.log("initial");var r={currentUser:t};return console.log(r),Object(P.jsx)("div",{children:Object(P.jsx)("button",{className:"sign-in",onClick:n,children:"Sign in with a Google"})})}Object(j.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{googleSignInStart:function(){return e({type:"GOOGLE_SIGN_IN_START"})}}}))(V),t(572);var W,Z,H=t(79),M=(t(304),t(567),t(173)),Q=t(141),Y=t(142);Y.a.button(W||(W=Object(Q.a)(['\n  min-width: 2px;\n  width: 80px;\n  height: auto;\n  letter-spacing: 0.5px;\n  line-height: 15px;\n  padding: 3px 3px 3px 3px;\n  font-size: 12px;\n  background-color: gray;\n  color: white;\n  text-transform: uppercase;\n  font-family: "Open Sans Condensed";\n  cursor: pointer;\n']))),Y.a.div(Z||(Z=Object(Q.a)(["\n  padding: 10px;\n\n  border-radius: 6px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n  background: white;\n  margin: 0 0 8px 0;\n  display: grid;\n  grid-gap: 20px;\n  flex-direction: column;\n"])));var q,X,$=Y.a.button(q||(q=Object(Q.a)(['\n  min-width: 2px;\n  width: 80px;\n  height: auto;\n  letter-spacing: 0.5px;\n  line-height: 15px;\n  padding: 3px 3px 3px 3px;\n  font-size: 12px;\n  background-color: gray;\n  color: white;\n  text-transform: uppercase;\n  font-family: "Open Sans Condensed";\n  cursor: pointer;\n']))),ee=Y.a.div(X||(X=Object(Q.a)(["\n  padding: 10px;\n\n  border-radius: 6px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n  background: white;\n  margin: 0 0 8px 0;\n  display: grid;\n  grid-gap: 20px;\n  flex-direction: column;\n"])));function ne(e){var n=e.message,t=n.text,r=n.uid,c=n.photoURL,a=r===d.currentUser.uid?"sent":"received";return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:"message ".concat(a),children:[Object(P.jsx)("img",{src:c||"https://api.adorable.io/avatars/23/abott@adorable.png"}),Object(P.jsx)("p",{children:t})]})})}var te=function(){var e=Object(r.useState)("messages"),n=Object(H.a)(e,2),t=n[0],c=n[1],a=b.collection("users").orderBy("createdAt").limit(10),s=Object(M.a)(a),i=Object(H.a)(s,1)[0],u=Object(r.useRef)(),f=b.collection(t),g=f.orderBy("createdAt").limit(25),m=Object(M.a)(g,{idField:"id"}),j=Object(H.a)(m,1)[0],x=Object(r.useState)(""),h=Object(H.a)(x,2),O=h[0],v=h[1],S=Object(r.useState)([]),y=Object(H.a)(S,2),w=(y[0],y[1],Object(r.useState)(!1)),I=Object(H.a)(w,2),U=I[0],k=I[1],N=function(){var e=Object(l.a)(o.a.mark((function e(n){var t,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=d.currentUser,r=t.uid,c=t.photoURL,e.next=4,f.add({text:O,createdAt:p.a.firestore.FieldValue.serverTimestamp(),uid:r,photoURL:c});case 4:v(""),u.current.scrollIntoView({behavior:"smooth"});case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_=["dinky013@hotmail.com","jorgeasimas@gmail.com"],G=["jorgeasimas@gmail.com","some@mail.com"],C=["dinky013@hotmail.com","some@mail.com"],E=["gustavo.mazzoni@gmail.com","some@mail.com"],A=["gustavo.mazzoni@gmail.com","jorgeasimas@gmail.com"],R=["dinky013@hotmail.com","gustavo.mazzoni@gmail.com"];return Object(P.jsx)("div",{children:Object(P.jsxs)("div",{className:"listGrid",children:[Object(P.jsx)("div",{className:"userList",children:i&&i.map((function(e){return Object(P.jsxs)(ee,{children:[Object(P.jsx)("span",{children:e.email}),Object(P.jsx)($,{onClick:function(){return function(e){console.log("open new chat");var n=[d.currentUser.email];n.push(e),console.log(n),function(e){e.length===_.length&&e.every((function(e){return _.includes(e)}))&&c("messages"),e.length===G.length&&e.every((function(e){return G.includes(e)}))&&c("messages2"),e.length===C.length&&e.every((function(e){return C.includes(e)}))&&c("messages3"),e.length===E.length&&e.every((function(e){return E.includes(e)}))&&c("messages4"),e.length===A.length&&e.every((function(e){return A.includes(e)}))&&c("messages5"),e.length===R.length&&e.every((function(e){return R.includes(e)}))&&c("messages6")}(n),k(!U)}(e.email)},children:"Start chat"})]})}))}),Object(P.jsxs)("main",{children:[j&&j.map((function(e){return Object(P.jsx)(ne,{message:e},e.id)})),Object(P.jsx)("span",{ref:u})]}),Object(P.jsxs)("form",{onSubmit:N,children:[Object(P.jsx)("input",{value:O,onChange:function(e){return v(e.target.value)},placeholder:"type your message"}),Object(P.jsx)("button",{type:"submit",disabled:!O,children:"SEND"})]})]})})};var re=Object(j.b)((function(e){return{currentUser:e.currentUser}}))((function(e){var n=e.currentUser;return console.log(n),Object(P.jsxs)("div",{className:"App",children:[Object(P.jsx)("header",{children:Object(P.jsx)(K,{})}),Object(P.jsx)("section",{children:n?Object(P.jsx)(te,{}):Object(P.jsx)(V,{})})]})}));s.a.render(Object(P.jsx)(j.a,{store:J,children:Object(P.jsx)(c.a.StrictMode,{children:Object(P.jsx)(re,{})})}),document.getElementById("root"))},175:function(e,n,t){},240:function(e,n){},578:function(e,n,t){},597:function(e,n){},599:function(e,n){},628:function(e,n){},630:function(e,n){},658:function(e,n){},660:function(e,n){},661:function(e,n){},666:function(e,n){},668:function(e,n){},674:function(e,n){},676:function(e,n){},695:function(e,n){},707:function(e,n){},710:function(e,n){},881:function(e,n){},978:function(e,n){},980:function(e,n){}},[[1127,1,2]]]);
//# sourceMappingURL=main.48d61b3b.chunk.js.map