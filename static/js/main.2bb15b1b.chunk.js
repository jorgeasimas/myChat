(this["webpackJsonpmy-chat"]=this["webpackJsonpmy-chat"]||[]).push([[0],{1006:function(e,t){},1008:function(e,t){},1010:function(e,t){},1036:function(e,t){},1038:function(e,t){},1080:function(e,t){},1082:function(e,t){},1127:function(e,t,n){"use strict";n.r(t);var r=n(3),c=n.n(r),a=n(208),s=n.n(a),o=(n(578),n(174),n(171),n(143),n(170),n(6)),i=n.n(o),u=n(85),p=n(137),l=n(72);l.a.initializeApp({apiKey:"AIzaSyBjtl5dVm-h0Uah1Kwt65--WnZJJRNlamo",authDomain:"my-chat-a7b6d.firebaseapp.com",projectId:"my-chat-a7b6d",storageBucket:"my-chat-a7b6d.appspot.com",messagingSenderId:"1074409928589",appId:"1:1074409928589:web:a9e5e3b5728e8377feefc4",measurementId:"G-NW4RYNZQ6E"}),l.a.analytics();var d=l.a.auth(),b=l.a.firestore(),f=(l.a.analytics(),b.collection("users")),x=function(){var e=Object(p.a)(i.a.mark((function e(t,n){var r,c,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return r=b.doc("users/".concat(t.uid)),e.next=5,r.get();case 5:if(e.sent.exists){e.next=17;break}return c=t.displayName,a=t.email,s=new Date,e.prev=9,e.next=12,r.set(Object(u.a)({displayName:c,email:a,createdAt:s},n));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.log("error creating user",e.t0.message);case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(t,n){return e.apply(this,arguments)}}(),j=new l.a.auth.GoogleAuthProvider;j.setCustomParameters({prompt:"select_account"}),f.get().then((function(e){e.forEach((function(e){console.log(e.data().displayName," => ",e.data())}))}));l.a;var h=n(139),O=n(48),g=n(573),m=n(173),v=i.a.mark(G),S=i.a.mark(E),w=i.a.mark(A),y=i.a.mark(R),I=i.a.mark(T),N=i.a.mark(L),U=i.a.mark(F),k=i.a.mark(z),_=function(e){return{type:"SIGN_IN_FAILURE",payload:e}},C={currentUser:null,error:null};function G(e,t){var n,r;return i.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Object(O.b)(x,e,t);case 3:return n=c.sent,c.next=6,n.get();case 6:return r=c.sent,console.log(r),c.next=10,Object(O.c)({type:"SIGN_IN_SUCCESS",payload:Object(u.a)({id:r.id},r.data())});case 10:c.next=16;break;case 12:return c.prev=12,c.t0=c.catch(0),c.next=16,Object(O.c)(_(c.t0));case 16:case"end":return c.stop()}}),v,null,[[0,12]])}function E(){var e,t;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("sigining in with google"),n.prev=1,n.next=4,Object(O.b)((function(){return d.signInWithPopup(j)}));case 4:return e=n.sent,t=e.user,n.next=8,G(t);case 8:console.log(t),n.next=15;break;case 11:return n.prev=11,n.t0=n.catch(1),n.next=15,Object(O.c)(_(n.t0));case 15:case"end":return n.stop()}}),S,null,[[1,11]])}function A(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(e,t){var n=d.onAuthStateChanged((function(t){n(),e(t)}),t)}));case 3:if(e=t.sent){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,G(e);case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(0),t.next=14,Object(O.c)(_(t.t0));case 14:case"end":return t.stop()}}),w,null,[[0,10]])}function R(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.signOut();case 3:return e.next=5,Object(O.c)({type:"SIGN_OUT_SUCCESS"});case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,Object(O.c)({type:"SIGN_OUT_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),y,null,[[0,7]])}function T(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.d)("GOOGLE_SIGN_IN_START",E);case 2:case"end":return e.stop()}}),I)}function L(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.e)("CHECK_USER_SESSION",A);case 2:case"end":return e.stop()}}),N)}function F(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.e)("SIGN_OUT_START",R);case 2:case"end":return e.stop()}}),U)}function z(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.a)([Object(O.b)(T),Object(O.b)(E),Object(O.b)(L),Object(O.b)(A),Object(O.b)(F)]);case 2:case"end":return e.stop()}}),k)}var B=Object(g.a)(),D=Object(m.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_IN_SUCCESS":return Object(u.a)(Object(u.a)({},e),{},{currentUser:t.payload,error:null});case"SIGN_OUT_SUCCESS":return console.log("sign in success"),Object(u.a)(Object(u.a)({},e),{},{currentUser:null,error:null});case"SIGN_IN_FAILURE":case"SIGN_OUT_FAILURE":return Object(u.a)(Object(u.a)({},e),{},{error:t.payload});default:return e}}),Object(m.a)(B));B.run(z);var J=D,P=n(10);function K(){return d.currentUser&&Object(P.jsx)("button",{className:"sign-out",onClick:function(){return d.signOut()},children:"Sign Out"})}function V(e){var t=e.googleSignInStart,n=e.currentUser;console.log("initial");var r={currentUser:n};return console.log(r),Object(P.jsx)("div",{children:Object(P.jsx)("button",{className:"sign-in",onClick:t,children:"Sign in with a Google"})})}Object(h.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{googleSignInStart:function(){return e({type:"GOOGLE_SIGN_IN_START"})}}}))(V);var W,Z,H=n(212),M=n(84),Q=(n(305),n(568),n(211)),Y=n(141),q=n(142);q.a.button(W||(W=Object(Y.a)(['\n  min-width: 2px;\n  width: 80px;\n  height: auto;\n  letter-spacing: 0.5px;\n  line-height: 15px;\n  padding: 3px 3px 3px 3px;\n  font-size: 12px;\n  background-color: gray;\n  color: white;\n  text-transform: uppercase;\n  font-family: "Open Sans Condensed";\n  cursor: pointer;\n']))),q.a.div(Z||(Z=Object(Y.a)(["\n  padding: 10px;\n\n  border-radius: 6px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n  background: white;\n  margin: 0 0 8px 0;\n  display: grid;\n  grid-gap: 20px;\n  flex-direction: column;\n"])));var X,$,ee=q.a.button(X||(X=Object(Y.a)(['\n  min-width: 2px;\n  width: 80px;\n  height: auto;\n  letter-spacing: 0.5px;\n  line-height: 15px;\n  padding: 3px 3px 3px 3px;\n  font-size: 12px;\n  background-color: gray;\n  color: white;\n  text-transform: uppercase;\n  font-family: "Open Sans Condensed";\n  cursor: pointer;\n']))),te=q.a.div($||($=Object(Y.a)(["\n  padding: 10px;\n\n  border-radius: 6px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n  background: white;\n  margin: 0 0 8px 0;\n  display: grid;\n  grid-gap: 20px;\n  flex-direction: column;\n"])));function ne(e){var t=e.message,n=t.text,r=t.uid,c=t.photoURL,a=r===d.currentUser.uid?"sent":"received";return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:"message ".concat(a),children:[Object(P.jsx)("img",{src:c||"https://api.adorable.io/avatars/23/abott@adorable.png"}),Object(P.jsx)("p",{children:n})]})})}var re=function(){var e=Object(r.useState)("messages"),t=Object(M.a)(e,2),n=t[0],c=t[1],a=b.collection("users"),s=Object(r.useRef)(),o=b.collection(n),u=o.orderBy("createdAt").limit(25),f=Object(Q.a)(u,{idField:"id"}),x=Object(M.a)(f,1)[0],j=Object(r.useState)(""),h=Object(M.a)(j,2),O=h[0],g=h[1],m=Object(r.useState)([]),v=Object(M.a)(m,2),S=v[0],w=v[1],y=Object(r.useState)(!1),I=Object(M.a)(y,2),N=I[0],U=I[1],k=function(){var e=Object(p.a)(i.a.mark((function e(t){var n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=d.currentUser,r=n.uid,c=n.photoURL,e.next=4,o.add({text:O,createdAt:l.a.firestore.FieldValue.serverTimestamp(),uid:r,photoURL:c});case 4:g(""),s.current.scrollIntoView({behavior:"smooth"});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsx)("div",{children:Object(P.jsxs)("div",{className:"listGrid",children:[Object(P.jsxs)("div",{className:"userList",children:[Object(P.jsx)("button",{onClick:function(){a.get().then((function(e){e.forEach((function(e){w([].concat(Object(H.a)(S),[e.data().email]))}))}))},children:"fetch all users"}),S.map((function(e,t){return Object(P.jsxs)(te,{children:[Object(P.jsx)("span",{children:e}),Object(P.jsx)(ee,{onClick:function(){return function(e){switch(console.log("open new chat"),e){case"jorgeasimas@gmail.com":return c("messages2");case"otheremail@gmail.com":return c("messages1")}U(!N)}(e)},children:"Start chat"})]})}))]}),Object(P.jsxs)("main",{children:[x&&x.map((function(e){return Object(P.jsx)(ne,{message:e},e.id)})),Object(P.jsx)("span",{ref:s})]}),Object(P.jsxs)("form",{onSubmit:k,children:[Object(P.jsx)("input",{value:O,onChange:function(e){return g(e.target.value)},placeholder:"type your message"}),Object(P.jsx)("button",{type:"submit",disabled:!O,children:"SEND"})]})]})})};var ce=Object(h.b)((function(e){return{currentUser:e.currentUser}}))((function(e){var t=e.currentUser;return console.log(t),Object(P.jsxs)("div",{className:"App",children:[Object(P.jsx)("header",{children:Object(P.jsx)(K,{})}),Object(P.jsx)("section",{children:t?Object(P.jsx)(re,{}):Object(P.jsx)(V,{})})]})}));s.a.render(Object(P.jsx)(h.a,{store:J,children:Object(P.jsx)(c.a.StrictMode,{children:Object(P.jsx)(ce,{})})}),document.getElementById("root"))},174:function(e,t,n){},241:function(e,t){},578:function(e,t,n){},597:function(e,t){},599:function(e,t){},628:function(e,t){},630:function(e,t){},658:function(e,t){},660:function(e,t){},661:function(e,t){},666:function(e,t){},668:function(e,t){},674:function(e,t){},676:function(e,t){},695:function(e,t){},707:function(e,t){},710:function(e,t){},881:function(e,t){},978:function(e,t){},980:function(e,t){}},[[1127,1,2]]]);
//# sourceMappingURL=main.2bb15b1b.chunk.js.map