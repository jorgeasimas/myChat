(this["webpackJsonpmy-chat"]=this["webpackJsonpmy-chat"]||[]).push([[0],{1006:function(e,n){},1008:function(e,n){},1010:function(e,n){},1036:function(e,n){},1038:function(e,n){},1080:function(e,n){},1082:function(e,n){},1127:function(e,n,t){"use strict";t.r(n);var r=t(3),c=t.n(r),a=t(209),o=t.n(a),s=(t(578),t(79)),i=(t(146),t(140),t(116),t(139),t(6)),u=t.n(i),l=t(85),p=t(141),d=t(65);d.a.initializeApp({apiKey:"AIzaSyBjtl5dVm-h0Uah1Kwt65--WnZJJRNlamo",authDomain:"my-chat-a7b6d.firebaseapp.com",projectId:"my-chat-a7b6d",storageBucket:"my-chat-a7b6d.appspot.com",messagingSenderId:"1074409928589",appId:"1:1074409928589:web:a9e5e3b5728e8377feefc4",measurementId:"G-NW4RYNZQ6E"}),d.a.analytics();var b=d.a.auth(),f=d.a.firestore(),j=(d.a.analytics(),f.collection("users")),m=function(){var e=Object(p.a)(u.a.mark((function e(n,t){var r,c,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return r=f.doc("users/".concat(n.uid)),e.next=5,r.get();case 5:if(e.sent.exists){e.next=17;break}return c=n.displayName,a=n.email,o=new Date,e.prev=9,e.next=12,r.set(Object(l.a)({displayName:c,email:a,createdAt:o},t));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.log("error creating user",e.t0.message);case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(n,t){return e.apply(this,arguments)}}(),x=new d.a.auth.GoogleAuthProvider;x.setCustomParameters({prompt:"select_account"}),j.get().then((function(e){e.forEach((function(e){console.log(e.data().displayName," => ",e.data())}))}));d.a;var g=t(107),h=t(48),O=t(573),v=t(175),S=u.a.mark(A),y=u.a.mark(E),w=u.a.mark(R),U=u.a.mark(T),I=u.a.mark(z),N=u.a.mark(L),k=u.a.mark(F),_=u.a.mark(B),G=function(e){return{type:"SIGN_IN_FAILURE",payload:e}},C={currentUser:null,error:null};function A(e,n){var t,r;return u.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Object(h.b)(m,e,n);case 3:return t=c.sent,c.next=6,t.get();case 6:return r=c.sent,console.log(r),c.next=10,Object(h.c)({type:"SIGN_IN_SUCCESS",payload:Object(l.a)({id:r.id},r.data())});case 10:c.next=16;break;case 12:return c.prev=12,c.t0=c.catch(0),c.next=16,Object(h.c)(G(c.t0));case 16:case"end":return c.stop()}}),S,null,[[0,12]])}function E(){var e,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("sigining in with google"),t.prev=1,t.next=4,Object(h.b)((function(){return b.signInWithPopup(x)}));case 4:return e=t.sent,n=e.user,t.next=8,A(n);case 8:console.log(n),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(1),t.next=15,Object(h.c)(G(t.t0));case 15:case"end":return t.stop()}}),y,null,[[1,11]])}function R(){var e;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,new Promise((function(e,n){var t=b.onAuthStateChanged((function(n){t(),e(n)}),n)}));case 3:if(e=n.sent){n.next=6;break}return n.abrupt("return");case 6:return n.next=8,A(e);case 8:n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(0),n.next=14,Object(h.c)(G(n.t0));case 14:case"end":return n.stop()}}),w,null,[[0,10]])}function T(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.signOut();case 3:return e.next=5,Object(h.c)({type:"SIGN_OUT_SUCCESS"});case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,Object(h.c)({type:"SIGN_OUT_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),U,null,[[0,7]])}function z(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.d)("GOOGLE_SIGN_IN_START",E);case 2:case"end":return e.stop()}}),I)}function L(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.e)("CHECK_USER_SESSION",R);case 2:case"end":return e.stop()}}),N)}function F(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("signing out"),e.next=3,Object(h.e)("SIGN_OUT_START",T);case 3:case"end":return e.stop()}}),k)}function B(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)([Object(h.b)(z),Object(h.b)(E),Object(h.b)(L),Object(h.b)(R),Object(h.b)(F)]);case 2:case"end":return e.stop()}}),_)}var D=Object(O.a)(),J=Object(v.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SIGN_IN_SUCCESS":return Object(l.a)(Object(l.a)({},e),{},{currentUser:n.payload,error:null});case"SIGN_OUT_SUCCESS":return console.log("sign in success"),Object(l.a)(Object(l.a)({},e),{},{currentUser:null,error:null});case"SIGN_IN_FAILURE":case"SIGN_OUT_FAILURE":return Object(l.a)(Object(l.a)({},e),{},{error:n.payload});default:return e}}),Object(v.a)(D));D.run(B);var P=J,K=t(10);function V(e){var n=e.googleSignInStart,t=e.currentUser;console.log("initial");var r={currentUser:t};return console.log(r),Object(K.jsx)("div",{children:Object(K.jsx)("button",{className:"sign-in",onClick:n,children:"Sign in with a Google"})})}Object(g.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{googleSignInStart:function(){return e({type:"GOOGLE_SIGN_IN_START"})}}}))(V);function W(e){e.signOutStart;return b.currentUser&&Object(K.jsx)("button",{className:"sign-out",onClick:function(){return b.signOut()},children:"Sign Out"})}Object(g.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{signOutStart:function(){return e({type:"SIGN_OUT_START"})}}}))(W),t(572),t(305);var Z,H,M=t(211),Q=t(174),Y=t(144),q=t(145);q.a.button(Z||(Z=Object(Y.a)(['\n  min-width: 2px;\n  width: 80px;\n  height: auto;\n  letter-spacing: 0.5px;\n  line-height: 15px;\n  padding: 3px 3px 3px 3px;\n  font-size: 12px;\n  background-color: gray;\n  color: white;\n  text-transform: uppercase;\n  font-family: "Open Sans Condensed";\n  cursor: pointer;\n']))),q.a.div(H||(H=Object(Y.a)(["\n  padding: 10px;\n\n  border-radius: 6px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n  background: white;\n  margin: 0 0 8px 0;\n  display: grid;\n  grid-gap: 20px;\n  flex-direction: column;\n"])));var X,$,ee=q.a.button(X||(X=Object(Y.a)(['\n  min-width: 2px;\n  width: 80px;\n  height: auto;\n  letter-spacing: 0.5px;\n  line-height: 15px;\n  padding: 3px 3px 3px 3px;\n  font-size: 12px;\n  background-color: gray;\n  color: white;\n  text-transform: uppercase;\n  font-family: "Open Sans Condensed";\n  cursor: pointer;\n']))),ne=q.a.div($||($=Object(Y.a)(["\n  padding: 10px;\n\n  border-radius: 6px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n  background: white;\n  margin: 0 0 8px 0;\n  display: grid;\n  grid-gap: 20px;\n  flex-direction: column;\n"])));function te(e){var n=e.message,t=n.text,r=n.uid,c=n.photoURL,a=r===b.currentUser.uid?"sent":"received";return Object(K.jsx)(K.Fragment,{children:Object(K.jsxs)("div",{className:"message ".concat(a),children:[Object(K.jsx)("img",{src:c}),Object(K.jsx)("p",{children:t})]})})}var re=function(){var e=Object(r.useState)("messages"),n=Object(s.a)(e,2),t=n[0],c=n[1],a=f.collection("users").orderBy("createdAt").limit(10),o=Object(Q.a)(a),i=Object(s.a)(o,1)[0],l=Object(r.useRef)(),j=f.collection(t),m=j.orderBy("createdAt").limit(25),x=Object(Q.a)(m,{idField:"id"}),g=Object(s.a)(x,1)[0],h=Object(r.useState)(""),O=Object(s.a)(h,2),v=O[0],S=O[1],y=function(){var e=Object(p.a)(u.a.mark((function e(n){var t,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=b.currentUser,r=t.uid,c=t.photoURL,e.next=4,j.add({text:v,createdAt:d.a.firestore.FieldValue.serverTimestamp(),uid:r,photoURL:c});case 4:S(""),l.current.scrollIntoView({behavior:"smooth"});case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),w=["dinky013@hotmail.com","jorgeasimas@gmail.com"],U=["jorgeasimas@gmail.com","some@mail.com"],I=["dinky013@hotmail.com","some@mail.com"],N=["gustavo.mazzoni@gmail.com","some@mail.com"],k=["gustavo.mazzoni@gmail.com","jorgeasimas@gmail.com"],_=["dinky013@hotmail.com","gustavo.mazzoni@gmail.com"];function G(e,n){return e.length===n.length&&e.every((function(e){return n.includes(e)}))}return Object(K.jsx)("div",{children:Object(K.jsxs)("div",{className:"listGrid",children:[Object(K.jsx)("div",{className:"userList",children:i&&i.map((function(e){return Object(K.jsxs)(ne,{children:[Object(K.jsx)("span",{children:e.email}),Object(K.jsx)(ee,{onClick:function(){return function(e){var n=[b.currentUser.email];n.push(e),console.log(n),G(n,w)&&c("".concat(w)),G(n,U)&&c("messages2"),G(n,I)&&c("messages3"),G(n,N)&&c("messages4"),G(n,k)&&c("".concat(k)),G(n,_)&&c("messages6")}(e.email)},children:"Start chat"})]})}))}),Object(K.jsxs)("main",{children:[g&&g.map((function(e){return Object(K.jsx)(te,{message:e},e.id)})),Object(K.jsx)("span",{ref:l})]}),Object(K.jsxs)("form",{onSubmit:y,children:[Object(K.jsx)("input",{value:v,onChange:function(e){return S(e.target.value)},placeholder:"type your message"}),Object(K.jsx)("button",{type:"submit",disabled:!v,children:"SEND"})]})]})})};var ce=Object(g.b)((function(e){return{currentUser:e.currentUser}}))((function(e){e.currentUser;var n=Object(M.a)(b),t=Object(s.a)(n,1)[0];return console.log(t),Object(K.jsxs)("div",{className:"App",children:[Object(K.jsx)("header",{children:Object(K.jsx)(W,{})}),Object(K.jsx)("section",{children:t?Object(K.jsx)(re,{}):Object(K.jsx)(V,{})})]})}));o.a.render(Object(K.jsx)(g.a,{store:P,children:Object(K.jsx)(c.a.StrictMode,{children:Object(K.jsx)(ce,{})})}),document.getElementById("root"))},146:function(e,n,t){},241:function(e,n){},578:function(e,n,t){},597:function(e,n){},599:function(e,n){},628:function(e,n){},630:function(e,n){},658:function(e,n){},660:function(e,n){},661:function(e,n){},666:function(e,n){},668:function(e,n){},674:function(e,n){},676:function(e,n){},695:function(e,n){},707:function(e,n){},710:function(e,n){},881:function(e,n){},978:function(e,n){},980:function(e,n){}},[[1127,1,2]]]);
//# sourceMappingURL=main.9b71f542.chunk.js.map